version: '3.8'

services:
  {{ inventory_hostname }}:
    image: "{{ docker_image }}"
    container_name: "{{ inventory_hostname }}"
    restart: always
    networks:
      - default
    environment:
      - ENVIRONMENT={{ environment }}
      - DB_HOST={{ db_host }}
      - DB_PORT={{ db_port }}
      - DB_USER={{ db_user }}
      - DB_PASSWORD={{ db_password }}
    volumes:
      - "{{ volumes }}"
    ports:
      - "{{ ports }}"
    depends_on:
      - {{ depends_on }}

networks:
  default:
    external:
      name: "{{ network_name }}"
